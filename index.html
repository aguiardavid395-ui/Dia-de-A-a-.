<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Dia de A√ßa√≠ - Final Corrigido</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f7f7f7; scroll-behavior: smooth; }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .tab-active { color: #ea1d2c; border-bottom: 2px solid #ea1d2c; }
    .payment-card { border: 2px solid #eee; transition: 0.2s; cursor: pointer; }
    .payment-card.selected { border-color: #ea1d2c; background-color: #fff5f5; }
  </style>
</head>
<body class="antialiased text-gray-800">

  <div id="login-screen" class="fixed inset-0 bg-white z-[100] flex flex-col items-center justify-center p-6 text-center">
      <div class="w-20 h-20 bg-purple-900 rounded-2xl flex items-center justify-center text-white text-3xl font-black mb-6">DA</div>
      <h1 class="text-2xl font-bold italic text-purple-900">Dia de A√ßa√≠</h1>
      <p class="text-gray-400 text-sm mb-8 font-medium">O melhor de Sarandi! <br>Insira seu nome para o pedido:</p>
      <input type="text" id="client-name" class="w-full max-w-xs p-4 bg-gray-100 rounded-xl mb-4 border-none outline-none font-bold text-center" placeholder="Seu Nome">
      <button onclick="iniciarApp()" class="w-full max-w-xs bg-[#ea1d2c] text-white py-4 rounded-xl font-bold shadow-lg active:scale-95 transition">Ver Card√°pio Completo</button>
  </div>

  <div id="main-app" class="hidden max-w-md mx-auto">
    
    <header class="sticky top-0 bg-white/95 backdrop-blur-md z-40 border-b">
        <div class="p-4 flex justify-between items-center">
            <h2 class="font-extrabold text-lg italic text-purple-900">Dia de A√ßa√≠</h2>
            <span class="text-[10px] font-bold text-green-600 bg-green-50 px-2 py-1 rounded-full uppercase">Aberto Agora</span>
        </div>
        <div class="flex gap-6 px-4 overflow-x-auto no-scrollbar font-bold text-sm text-gray-400">
            <button onclick="scrollToSection('destaques')" class="category-btn tab-active pb-2 whitespace-nowrap">Favoritos</button>
            <button onclick="scrollToSection('monte')" class="category-btn pb-2 whitespace-nowrap">Montar Copo</button>
            <button onclick="scrollToSection('bebidas')" class="category-btn pb-2 whitespace-nowrap">Bebidas</button>
        </div>
    </header>

    <main class="p-4 space-y-8 pb-32">
        
        <section id="destaques" class="scroll-mt-28">
            <div class="flex flex-col mb-4">
                <h3 class="font-extrabold text-gray-900 text-lg">Os Mais Pedidos üî•</h3>
                <p class="text-xs text-gray-400">Troque ingredientes √† vontade, cobramos apenas os extras.</p>
            </div>
            
            <div class="space-y-3">
                <div onclick="abrirModal('Copo Kinder 400ml', 28.90, 2, 3, ['Morango','Banana'], ['Nutella','Leite P√≥','Granola'])" class="bg-white p-4 rounded-2xl border-b-4 border-gray-100 flex flex-col cursor-pointer active:bg-gray-50">
                    <div class="flex justify-between items-start">
                        <span class="font-bold text-gray-800">Copo Kinder 400ml</span>
                        <span class="font-extrabold text-[#ea1d2c]">R$ 28,90</span>
                    </div>
                    <span class="text-[11px] text-purple-600 font-bold mt-1 uppercase tracking-tighter">J√° vai com: Morango, Banana, Nutella, Leite P√≥ e Granola.</span>
                </div>

                <div onclick="abrirModal('Supremo 700ml', 31.90, 2, 4, ['Banana','Morango'], ['Pa√ßoca','Bis','Leite P√≥','M&Ms'])" class="bg-white p-4 rounded-2xl border-b-4 border-gray-100 flex flex-col cursor-pointer active:bg-gray-50">
                    <div class="flex justify-between items-start">
                        <span class="font-bold text-gray-800">Supremo 700ml</span>
                        <span class="font-extrabold text-[#ea1d2c]">R$ 31,90</span>
                    </div>
                    <span class="text-[11px] text-purple-600 font-bold mt-1 uppercase tracking-tighter">J√° vai com: Banana, Morango, Pa√ßoca, Bis, Leite P√≥ e M&Ms.</span>
                </div>
            </div>
        </section>

        <section id="monte" class="scroll-mt-28">
            <h3 class="font-extrabold text-gray-900 text-lg mb-4">ü•£ Monte do seu jeito</h3>
            <div class="space-y-3">
                <div onclick="abrirModal('A√ßa√≠ 330ml', 13.50, 2, 1, [], [])" class="bg-white p-4 rounded-2xl border-b-4 border-gray-100 flex flex-col cursor-pointer">
                    <div class="flex justify-between">
                        <span class="font-bold">A√ßa√≠ 330ml</span>
                        <span class="font-extrabold text-[#ea1d2c]">R$ 13,50</span>
                    </div>
                    <span class="text-[11px] text-gray-400 mt-1 uppercase">Incluso 2 Frutas e 1 Complemento.</span>
                </div>

                <div onclick="abrirModal('A√ßa√≠ 500ml', 18.90, 3, 2, [], [])" class="bg-white p-4 rounded-2xl border-b-4 border-gray-100 flex flex-col cursor-pointer">
                    <div class="flex justify-between">
                        <span class="font-bold">A√ßa√≠ 500ml</span>
                        <span class="font-extrabold text-[#ea1d2c]">R$ 18,90</span>
                    </div>
                    <span class="text-[11px] text-gray-400 mt-1 uppercase">Incluso 3 Frutas e 2 Complementos.</span>
                </div>
            </div>
        </section>

        <section id="bebidas" class="scroll-mt-28">
            <h3 class="font-extrabold text-gray-900 text-lg mb-4">ü•§ Bebidas</h3>
            <div class="bg-white p-4 rounded-2xl border-b-4 border-gray-100 flex justify-between items-center">
                <div>
                    <span class="font-bold block">√Ågua Mineral 500ml</span>
                    <span class="font-extrabold text-[#ea1d2c]">R$ 3,50</span>
                </div>
                <button onclick="addAgua()" class="bg-green-500 text-white px-4 py-2 rounded-lg font-bold text-sm shadow-md active:scale-90 transition">+ Adicionar</button>
            </div>
        </section>
    </main>

    <div id="bag-bar" class="fixed bottom-0 left-0 right-0 p-4 bg-white border-t hidden z-50">
        <button onclick="verSacola()" class="w-full bg-[#ea1d2c] text-white h-14 rounded-xl flex justify-between items-center px-6 font-bold">
            <div class="flex items-center gap-2"><span id="bag-count" class="bg-black/20 px-2 rounded">0</span><span>Ver Sacola</span></div>
            <span id="bag-total">R$ 0,00</span>
        </button>
    </div>

    <div id="modal-item" class="fixed inset-0 z-[60] bg-black/50 hidden">
        <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-[32px] max-h-[90vh] overflow-y-auto p-6">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 id="m-nome" class="text-xl font-extrabold text-purple-900 leading-tight"></h2>
                    <p class="text-[10px] text-gray-400 font-bold uppercase tracking-widest mt-1">Troque os itens abaixo</p>
                </div>
                <button onclick="fecharModal()" class="text-gray-300 text-2xl">‚úï</button>
            </div>

            <div class="space-y-6 mb-32">
                <div class="bg-yellow-50 p-3 rounded-xl border border-yellow-100 text-[11px] font-bold text-yellow-700">
                    üí° DICA: Voc√™ pode desmarcar o que vem no copo e escolher outro! Extras: Fruta +R$2,50 | Comp. +R$3,50
                </div>

                <div>
                    <h4 class="font-bold text-sm mb-4">Frutas (<span id="f-limit-text">0/0</span>)</h4>
                    <div id="list-f" class="grid grid-cols-1 gap-2"></div>
                </div>
                <div>
                    <h4 class="font-bold text-sm mb-4">Complementos (<span id="c-limit-text">0/0</span>)</h4>
                    <div id="list-c" class="grid grid-cols-1 gap-2"></div>
                </div>
                <div>
                    <h4 class="font-bold text-sm mb-2">Observa√ß√£o</h4>
                    <textarea id="m-obs" class="w-full bg-gray-100 rounded-xl p-4 text-sm outline-none border-none" placeholder="Ex: Caprichar na Nutella..."></textarea>
                </div>
            </div>

            <div class="fixed bottom-0 left-0 right-0 p-6 bg-white border-t flex gap-4">
                <div class="flex items-center bg-gray-100 rounded-xl px-2">
                    <button onclick="mudarQtd(-1)" class="w-10 h-10 text-xl font-bold">‚àí</button>
                    <span id="m-qty" class="w-8 text-center font-bold">1</span>
                    <button onclick="mudarQtd(1)" class="w-10 h-10 text-xl font-bold">+</button>
                </div>
                <button onclick="addSacola()" class="flex-1 bg-[#ea1d2c] text-white rounded-xl font-bold flex justify-between items-center px-4">
                    <span>Adicionar</span><span id="m-total">R$ 0,00</span>
                </button>
            </div>
        </div>
    </div>

    <div id="checkout" class="fixed inset-0 z-[70] bg-white hidden overflow-y-auto">
        <div class="p-4 border-b flex items-center gap-4 bg-white sticky top-0">
            <button onclick="verSacola()" class="text-[#ea1d2c] font-bold text-2xl">‚ùÆ</button>
            <h2 class="font-extrabold">Revis√£o do Pedido</h2>
        </div>

        <div class="p-6 pb-20">
            <div id="lista-checkout" class="space-y-4 mb-8"></div>

            <div class="mb-8">
                <h4 class="font-bold text-sm mb-3">Endere√ßo de Entrega</h4>
                <input id="addr" type="text" placeholder="Rua, N√∫mero e Bairro" class="w-full p-4 bg-gray-50 rounded-xl outline-none border-2 border-transparent focus:border-red-500 font-bold">
            </div>

            <div class="mb-8">
                <h4 class="font-bold text-sm mb-3">Forma de Pagamento</h4>
                <div class="space-y-2">
                    <div onclick="setPagamento('Pix')" class="payment-card p-4 rounded-xl flex items-center justify-between" id="pay-pix">
                        <span class="font-bold">Pix</span>
                    </div>
                    <div onclick="setPagamento('Cart√£o')" class="payment-card p-4 rounded-xl" id="pay-card">
                        <span class="font-bold">Cart√£o (Entregador leva a m√°quina)</span>
                    </div>
                    <div onclick="setPagamento('Dinheiro')" class="payment-card p-4 rounded-xl" id="pay-cash">
                        <span class="font-bold">Dinheiro</span>
                    </div>
                </div>

                <div id="campo-troco" class="hidden mt-4 p-4 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200">
                    <h4 class="font-bold text-sm mb-2">Vai pagar com quanto?</h4>
                    <input id="pag-valor" type="number" oninput="calcTroco()" placeholder="Ex: 50.00" class="w-full p-3 rounded-lg border-none font-bold text-lg">
                    <p id="resultado-troco" class="mt-2 text-sm font-bold text-green-600"></p>
                </div>

                <div id="campo-pix" class="hidden mt-4 p-4 bg-purple-50 rounded-xl border border-purple-200 text-center">
                    <p class="text-[10px] font-black uppercase text-purple-900 italic">Chave Pix Celular:</p>
                    <p class="font-black text-xl text-purple-700">44988569863</p>
                    <p class="text-[10px] text-purple-400 mt-1 font-bold">DIA DE A√áA√ç EXPRESS</p>
                </div>
            </div>

            <div class="bg-gray-900 p-6 rounded-[32px] space-y-3 font-bold text-white shadow-xl">
                <div class="flex justify-between text-gray-400 text-sm"><span>Produtos</span><span id="sub-final">R$ 0,00</span></div>
                <div class="flex justify-between text-green-400 text-sm"><span>Entrega</span><span>R$ 7,50</span></div>
                <div class="flex justify-between text-2xl font-black pt-4 border-t border-gray-800"><span>Total</span><span id="total-final">R$ 0,00</span></div>
            </div>

            <button onclick="enviarPedido()" class="w-full bg-[#ea1d2c] text-white py-5 rounded-2xl font-black text-lg mt-10 shadow-lg shadow-red-200 uppercase tracking-widest active:scale-95 transition">Pedir agora no Zap</button>
        </div>
    </div>

  </div>

  <script>
    let sacola = []; let cur = null; let nome = ''; let pag = ''; let totalGeral = 0;
    const db = { 
        f: ['Morango','Banana','Uva','Manga','Kiwi'], 
        c: ['Nutella','Leite P√≥','Granola','Pa√ßoca','Oreo','M&Ms','Bis','Leite Condensado'] 
    };

    function iniciarApp() {
        nome = document.getElementById('client-name').value;
        if(!nome) return alert("Por favor, insira seu nome!");
        document.getElementById('login-screen').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
    }

    function scrollToSection(id) {
        document.getElementById(id).scrollIntoView();
        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('tab-active'));
        event.target.classList.add('tab-active');
    }

    function abrirModal(n, p, fL, cL, fS=[], cS=[]) {
        cur = { nome: n, preco: p, fL: fL, cL: cL, f: [...fS], c: [...cS], q: 1 };
        document.getElementById('m-nome').innerText = n;
        renderOps('list-f', db.f, 'f');
        renderOps('list-c', db.c, 'c');
        calcModal();
        document.getElementById('modal-item').classList.remove('hidden');
    }

    function renderOps(id, list, type) {
        document.getElementById(id).innerHTML = list.map(opt => {
            const isSel = cur[type].includes(opt);
            return `<div onclick="toggleOpt(this,'${type}','${opt}')" class="p-4 rounded-xl border-2 flex justify-between items-center ${isSel ? 'border-[#ea1d2c] bg-red-50' : 'border-gray-50 bg-gray-50'}">
                <span class="text-sm font-bold text-gray-700">${opt}</span>
                <div class="w-5 h-5 rounded-full border-2 ${isSel ? 'bg-[#ea1d2c] border-[#ea1d2c]' : 'border-gray-200'}"></div>
            </div>`;
        }).join('');
    }

    function toggleOpt(el, type, val) {
        const i = cur[type].indexOf(val);
        if(i > -1) cur[type].splice(i, 1); else cur[type].push(val);
        renderOps(type === 'f' ? 'list-f' : 'list-c', db[type === 'f' ? 'f' : 'c'], type);
        calcModal();
    }

    function calcModal() {
        const exF = Math.max(0, cur.f.length - cur.fL) * 2.50;
        const exC = Math.max(0, cur.c.length - cur.cL) * 3.50;
        const total = (cur.preco + exF + exC) * cur.q;
        document.getElementById('m-total').innerText = `R$ ${total.toFixed(2).replace('.',',')}`;
        document.getElementById('m-qty').innerText = cur.q;
        document.getElementById('f-limit-text').innerText = `${cur.f.length}/${cur.fL}`;
        document.getElementById('c-limit-text').innerText = `${cur.c.length}/${cur.cL}`;
    }

    function mudarQtd(v) { cur.q = Math.max(1, cur.q + v); calcModal(); }
    function fecharModal() { document.getElementById('modal-item').classList.add('hidden'); }

    function addSacola() {
        const exF = Math.max(0, cur.f.length - cur.fL) * 2.50;
        const exC = Math.max(0, cur.c.length - cur.cL) * 3.50;
        const total = (cur.preco + exF + exC) * cur.q;
        sacola.push({...cur, total, obs: document.getElementById('m-obs').value});
        updateBag(); fecharModal();
    }

    function addAgua() {
        sacola.push({nome: '√Ågua Mineral 500ml', total: 3.50, q: 1, f: [], c: [], obs: ''});
        updateBag();
    }

    function updateBag() {
        const sub = sacola.reduce((acc, i) => acc + i.total, 0);
        totalGeral = sub + 7.50;
        document.getElementById('bag-count').innerText = sacola.length;
        document.getElementById('bag-total').innerText = `R$ ${totalGeral.toFixed(2).replace('.', ',')}`;
        document.getElementById('bag-bar').classList.toggle('hidden', sacola.length === 0);
    }

    function verSacola() {
        document.getElementById('checkout').classList.toggle('hidden');
        const sub = sacola.reduce((acc, i) => acc + i.total, 0);
        document.getElementById('lista-checkout').innerHTML = sacola.map((i, idx) => `
            <div class="flex justify-between items-center border-b pb-4">
                <div>
                    <h5 class="font-bold text-sm">${i.q}x ${i.nome}</h5>
                    <p class="text-[10px] text-gray-400 font-bold">${[...i.f, ...i.c].join(', ')}</p>
                    <p class="text-sm font-black text-[#ea1d2c] mt-1">R$ ${i.total.toFixed(2).replace('.',',')}</p>
                </div>
                <button onclick="remover(${idx})" class="text-gray-300 font-black text-xs border p-1 rounded">X</button>
            </div>`).join('');
        document.getElementById('sub-final').innerText = `R$ ${sub.toFixed(2).replace('.',',')}`;
        document.getElementById('total-final').innerText = `R$ ${totalGeral.toFixed(2).replace('.',',')}`;
        calcTroco();
    }

    function remover(idx) { 
        sacola.splice(idx, 1); 
        if(sacola.length === 0) document.getElementById('checkout').classList.add('hidden');
        verSacola(); updateBag(); 
    }

    function setPagamento(t) {
        pag = t;
        document.getElementById('pay-pix').className = "payment-card p-4 rounded-xl " + (t==='Pix'?'selected':'');
        document.getElementById('pay-card').className = "payment-card p-4 rounded-xl " + (t==='Cart√£o'?'selected':'');
        document.getElementById('pay-cash').className = "payment-card p-4 rounded-xl " + (t==='Dinheiro'?'selected':'');
        document.getElementById('campo-troco').classList.toggle('hidden', t !== 'Dinheiro');
        document.getElementById('campo-pix').classList.toggle('hidden', t !== 'Pix');
        calcTroco();
    }

    function calcTroco() {
        const v = parseFloat(document.getElementById('pag-valor').value);
        const res = document.getElementById('resultado-troco');
        if(v > totalGeral) {
            res.innerText = `Seu troco ser√°: R$ ${(v - totalGeral).toFixed(2).replace('.',',')}`;
        } else {
            res.innerText = "";
        }
    }

    function enviarPedido() {
        const addr = document.getElementById('addr').value;
        const vPag = document.getElementById('pag-valor').value;
        if(!addr || !pag) return alert("Preencha o Endere√ßo e Pagamento!");
        
        let msg = `*PEDIDO DIA DE A√áA√ç*\n\nüë§ *CLIENTE:* ${nome}\nüìç *ENDERE√áO:* ${addr}\nüí≥ *PAGAMENTO:* ${pag}\n`;
        
        if(pag === 'Dinheiro' && vPag) {
            const troco = (parseFloat(vPag) - totalGeral);
            msg += `üíµ *PAGO COM:* R$ ${vPag}\nü™ô *TROCO:* R$ ${troco > 0 ? troco.toFixed(2) : '0,00'}\n`;
        }
        
        msg += `\n*ITENS:*\n`;
        sacola.forEach(i => {
            msg += `‚Ä¢ ${i.q}x ${i.nome} (R$ ${i.total.toFixed(2)})\n`;
            if([...i.f, ...i.c].length > 0) msg += `  _Ingredientes: ${[...i.f, ...i.c].join(', ')}_\n`;
            if(i.obs) msg += `  _Obs: ${i.obs}_\n`;
        });
        
        msg += `\nüõµ *ENTREGA:* R$ 7,50\n*TOTAL: R$ ${totalGeral.toFixed(2)}*`;
        window.open(`https://wa.me/5544988569863?text=${encodeURIComponent(msg)}`);
    }
  </script>
</body>
</html>
